<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Postbacks &mdash; Xitrum Scala Web Framework Guide 3.22 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.22',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Xitrum Scala Web Framework Guide 3.22 documentation" href="index.html" />
    <link rel="next" title="XML" href="xml.html" />
    <link rel="prev" title="Template engines" href="template_engines.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="xml.html" title="XML"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="template_engines.html" title="Template engines"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Xitrum Scala Web Framework Guide 3.22 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="postbacks">
<h1>Postbacks<a class="headerlink" href="#postbacks" title="Permalink to this headline">¶</a></h1>
<p>Có 2 use case chính của ứng dụng web:</p>
<ul class="simple">
<li>Để phục vụ các thiết bị: bạn cần tạo các RESTful APIs cho smartphones, web service cho các web site khác.</li>
<li>Để phục vụ các người dùng cuối: bạn cần tạo giao diện web.</li>
</ul>
<p>Như một web framework thông thường, Xitrum hướng tới việc hỗ trợ giải quyết các use case một cách dễ dàng. Để giải quyết use case đầu tiền, bạn sử dụng <a class="reference internal" href="restful.html"><em>RESTful actions</em></a>. Để giải quyết use case thứ hai, bạn có thể sử dụng tính năng Ajax form postback của Xitrum.
Bạn có thể xem thêm các trang dưới đây để biết thêm về postback:</p>
<ul class="simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Postback">http://en.wikipedia.org/wiki/Postback</a></li>
<li><a class="reference external" href="http://nitrogenproject.com/doc/tutorial.html">http://nitrogenproject.com/doc/tutorial.html</a></li>
</ul>
<p>Tính năng postback của Xitrum có liên hệ tới <a class="reference external" href="http://nitrogenproject.com/">Nitrogen</a>.</p>
<div class="section" id="layout">
<h2>Layout<a class="headerlink" href="#layout" title="Permalink to this headline">¶</a></h2>
<p>AppAction.scala</p>
<div class="highlight-python"><div class="highlight"><pre>import xitrum.Action
import xitrum.view.DocType

trait AppAction extends Action {
  override def layout = DocType.html5(
    &lt;html&gt;
      &lt;head&gt;
        {antiCsrfMeta}
        {xitrumCss}
        {jsDefaults}
        &lt;title&gt;Welcome to Xitrum&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
        {renderedView}
        {jsForView}
      &lt;/body&gt;
    &lt;/html&gt;
  )
}
</pre></div>
</div>
</div>
<div class="section" id="form">
<h2>Form<a class="headerlink" href="#form" title="Permalink to this headline">¶</a></h2>
<p>Articles.scala</p>
<div class="highlight-python"><div class="highlight"><pre>import xitrum.annotation.{GET, POST, First}
import xitrum.validator._

@GET(&quot;articles/:id&quot;)
class ArticlesShow extends AppAction {
  def execute() {
    val id      = param(&quot;id&quot;)
    val article = Article.find(id)
    respondInlineView(
      &lt;h1&gt;{article.title}&lt;/h1&gt;
      &lt;div&gt;{article.body}&lt;/div&gt;
    )
  }
}

@First  // Force this route to be matched before &quot;show&quot;
@GET(&quot;articles/new&quot;)
class ArticlesNew extends AppAction {
  def execute() {
    respondInlineView(
      &lt;form data-postback=&quot;submit&quot; action={url[ArticlesCreate]}&gt;
        &lt;label&gt;Title&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;title&quot; class=&quot;required&quot; /&gt;&lt;br /&gt;

        &lt;label&gt;Body&lt;/label&gt;
        &lt;textarea name=&quot;body&quot; class=&quot;required&quot;&gt;&lt;/textarea&gt;&lt;br /&gt;

        &lt;input type=&quot;submit&quot; value=&quot;Save&quot; /&gt;
      &lt;/form&gt;
    )
  }
}

@POST(&quot;articles&quot;)
class ArticlesCreate extends AppAction {
  def execute() {
    val title   = param(&quot;title&quot;)
    val body    = param(&quot;body&quot;)
    val article = Article.save(title, body)

    flash(&quot;Article has been saved.&quot;)
    jsRedirectTo(show, &quot;id&quot; -&gt; article.id)
  }
}
</pre></div>
</div>
<p>Khi sự kiện <tt class="docutils literal"><span class="pre">submit</span></tt> của JavaScript trong form xảy ra, form sẽ postback về <tt class="docutils literal"><span class="pre">ArticlesCreate</span></tt>.</p>
<p>Thuộc tính <tt class="docutils literal"><span class="pre">action</span></tt> của <tt class="docutils literal"><span class="pre">&lt;form&gt;</span></tt> được tạo ra. URL được mã hóa hoạt động như một anti-CSRF token.</p>
</div>
<div class="section" id="non-form">
<h2>Non-form<a class="headerlink" href="#non-form" title="Permalink to this headline">¶</a></h2>
<p>Postback có thể được đặt trong bất kỳ phần tử nào, không chỉ là form.</p>
<p>Một ví dụ sử dụng link:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;a href=&quot;#&quot; data-postback=&quot;click&quot; action={postbackUrl[LogoutAction]}&gt;Logout&lt;/a&gt;
</pre></div>
</div>
<p>Khi click vào link ở trên sẽ tạo ra postback đến LogoutAction.</p>
</div>
<div class="section" id="hop-thoai-xac-nhan">
<h2>Hộp thoại xác nhận<a class="headerlink" href="#hop-thoai-xac-nhan" title="Permalink to this headline">¶</a></h2>
<p>Nếu bạn muốn hiển thị một hộp thoại xác nhận:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;a href=&quot;#&quot; data-postback=&quot;click&quot;
            action={url[LogoutAction]}
            data-confirm=&quot;Do you want to logout?&quot;&gt;Logout&lt;/a&gt;
</pre></div>
</div>
<p>Nếu người dùng click &#8220;Cancel&#8221;, postback sẽ không được gửi đi.</p>
</div>
<div class="section" id="them-parameter-khac">
<h2>Thêm parameter khác<a class="headerlink" href="#them-parameter-khac" title="Permalink to this headline">¶</a></h2>
<p>Với các form element, bạn có thể thêm <tt class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">type=&quot;hidden&quot;...</span></tt> để gửi thêm các parameter khác với postback.</p>
<p>Với các element khác, bạn làm như sau:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;a href=&quot;#&quot;
   data-postback=&quot;click&quot;
   action={url[ArticlesDestroy](&quot;id&quot; -&gt; item.id)}
   data-params=&quot;_method=delete&quot;
   data-confirm={&quot;Do you want to delete %s?&quot;.format(item.name)}&gt;Delete&lt;/a&gt;
</pre></div>
</div>
<p>Bạn cũng có thể thêm các parameter trong một form riêng biệt:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;form id=&quot;myform&quot; data-postback=&quot;submit&quot; action={url[SiteSearch]}&gt;
  Search:
  &lt;input type=&quot;text&quot; name=&quot;keyword&quot; /&gt;

  &lt;a class=&quot;pagination&quot;
     href=&quot;#&quot;
     data-postback=&quot;click&quot;
     data-form=&quot;#myform&quot;
     action={url[SiteSearch](&quot;page&quot; -&gt; page)}&gt;{page}&lt;/a&gt;
&lt;/form&gt;
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">#myform</span></tt> là một jQuery selector để chọn form có chứa các parameter được thêm vào.</p>
</div>
<div class="section" id="hien-thi-hinh-dong-khi-load-ajax">
<h2>Hiện thị hình động khi load Ajax<a class="headerlink" href="#hien-thi-hinh-dong-khi-load-ajax" title="Permalink to this headline">¶</a></h2>
<p>Nếu bạn muốn hiển thị hình ảnh như thế này khi load Ajax</p>
<img alt="_images/ajax_loading.png" src="_images/ajax_loading.png" />
<p>bạn có thể gọi JS snippet này sau khi đã include <tt class="docutils literal"><span class="pre">jsDefaults</span></tt> (đã include
<a class="reference external" href="https://github.com/xitrum-framework/xitrum/blob/master/src/main/scala/xitrum/js.scala">xitrum.js</a>) trong view template của bạn:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xitrum</span><span class="o">.</span><span class="n">ajaxLoadingImg</span> <span class="o">=</span> <span class="s">&#39;path/to/your/image&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Postbacks</a><ul>
<li><a class="reference internal" href="#layout">Layout</a></li>
<li><a class="reference internal" href="#form">Form</a></li>
<li><a class="reference internal" href="#non-form">Non-form</a></li>
<li><a class="reference internal" href="#hop-thoai-xac-nhan">Hộp thoại xác nhận</a></li>
<li><a class="reference internal" href="#them-parameter-khac">Thêm parameter khác</a></li>
<li><a class="reference internal" href="#hien-thi-hinh-dong-khi-load-ajax">Hiện thị hình động khi load Ajax</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="template_engines.html"
                        title="previous chapter">Template engines</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="xml.html"
                        title="next chapter">XML</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/postback.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="xml.html" title="XML"
             >next</a> |</li>
        <li class="right" >
          <a href="template_engines.html" title="Template engines"
             >previous</a> |</li>
        <li><a href="index.html">Xitrum Scala Web Framework Guide 3.22 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Ngoc Dao.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>