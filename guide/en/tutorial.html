<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial &mdash; Xitrum Scala Web Framework Guide 3.15 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.15',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Xitrum Scala Web Framework Guide 3.15 documentation" href="index.html" />
    <link rel="next" title="Action and view" href="action_view.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="action_view.html" title="Action and view"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Xitrum Scala Web Framework Guide 3.15 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>This chapter shortly describes how to create and run a Xitrum project.
<strong>It assumes that you are using Linux and you have installed Java.</strong></p>
<div class="section" id="create-a-new-empty-xitrum-project">
<h2>Create a new empty Xitrum project<a class="headerlink" href="#create-a-new-empty-xitrum-project" title="Permalink to this headline">¶</a></h2>
<p>To create a new empty project, download
<a class="reference external" href="https://github.com/xitrum-framework/xitrum-new/archive/master.zip">xitrum-new.zip</a>:</p>
<div class="highlight-python"><div class="highlight"><pre>wget -O xitrum-new.zip https://github.com/xitrum-framework/xitrum-new/archive/master.zip
</pre></div>
</div>
<p>Or:</p>
<div class="highlight-python"><div class="highlight"><pre>curl -L -o xitrum-new.zip https://github.com/xitrum-framework/xitrum-new/archive/master.zip
</pre></div>
</div>
</div>
<div class="section" id="run">
<h2>Run<a class="headerlink" href="#run" title="Permalink to this headline">¶</a></h2>
<p>The de facto stardard way of building Scala projects is using
<a class="reference external" href="https://github.com/harrah/xsbt/wiki/Setup">SBT</a>. The newly created project
has already included SBT 0.13 in <tt class="docutils literal"><span class="pre">sbt</span></tt> directory. If you want to install
SBT yourself, see its <a class="reference external" href="https://github.com/harrah/xsbt/wiki/Setup">setup guide</a>.</p>
<p>Change to the newly created project directory and run <tt class="docutils literal"><span class="pre">sbt/sbt</span> <span class="pre">run</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>unzip xitrum-new.zip
cd xitrum-new
sbt/sbt run
</pre></div>
</div>
<p>This command will download all <a class="reference internal" href="deps.html"><em>dependencies</em></a>, compile the project,
and run the class <tt class="docutils literal"><span class="pre">quickstart.Boot</span></tt>, which starts the web server. In the console,
you will see all the routes:</p>
<div class="highlight-python"><div class="highlight"><pre>[INFO] Load routes.cache or recollect routes...
[INFO] Normal routes:
GET  /  quickstart.action.SiteIndex
[INFO] SockJS routes:
xitrum/metrics/channel  xitrum.metrics.XitrumMetricsChannel  websocket: true, cookie_needed: false
[INFO] Error routes:
404  quickstart.action.NotFoundError
500  quickstart.action.ServerError
[INFO] Xitrum routes:
GET        /webjars/swagger-ui/2.0.17/index                            xitrum.routing.SwaggerUiVersioned
GET        /xitrum/xitrum.js                                           xitrum.js
GET        /xitrum/metrics/channel                                     xitrum.sockjs.Greeting
GET        /xitrum/metrics/channel/:serverId/:sessionId/eventsource    xitrum.sockjs.EventSourceReceive
GET        /xitrum/metrics/channel/:serverId/:sessionId/htmlfile       xitrum.sockjs.HtmlFileReceive
GET        /xitrum/metrics/channel/:serverId/:sessionId/jsonp          xitrum.sockjs.JsonPPollingReceive
POST       /xitrum/metrics/channel/:serverId/:sessionId/jsonp_send     xitrum.sockjs.JsonPPollingSend
WEBSOCKET  /xitrum/metrics/channel/:serverId/:sessionId/websocket      xitrum.sockjs.WebSocket
POST       /xitrum/metrics/channel/:serverId/:sessionId/xhr            xitrum.sockjs.XhrPollingReceive
POST       /xitrum/metrics/channel/:serverId/:sessionId/xhr_send       xitrum.sockjs.XhrSend
POST       /xitrum/metrics/channel/:serverId/:sessionId/xhr_streaming  xitrum.sockjs.XhrStreamingReceive
GET        /xitrum/metrics/channel/info                                xitrum.sockjs.InfoGET
WEBSOCKET  /xitrum/metrics/channel/websocket                           xitrum.sockjs.RawWebSocket
GET        /xitrum/metrics/viewer                                      xitrum.metrics.XitrumMetricsViewer
GET        /xitrum/metrics/channel/:iframe                             xitrum.sockjs.Iframe
GET        /xitrum/metrics/channel/:serverId/:sessionId/websocket      xitrum.sockjs.WebSocketGET
POST       /xitrum/metrics/channel/:serverId/:sessionId/websocket      xitrum.sockjs.WebSocketPOST
[INFO] HTTP server started on port 8000
[INFO] HTTPS server started on port 4430
[INFO] Xitrum started in development mode
</pre></div>
</div>
<p>On startup, all routes will be collected and output to log. It is very
convenient for you to have a list of routes if you want to write documentation
for 3rd parties about the RESTful APIs in your web application.</p>
<p>Open <a class="reference external" href="http://localhost:8000/">http://localhost:8000/</a> or <a class="reference external" href="https://localhost:4430/">https://localhost:4430/</a> in your browser. In the
console you will see request information:</p>
<div class="highlight-python"><div class="highlight"><pre>[INFO] GET quickstart.action.SiteIndex, 1 [ms]
</pre></div>
</div>
</div>
<div class="section" id="autoreload">
<h2>Autoreload<a class="headerlink" href="#autoreload" title="Permalink to this headline">¶</a></h2>
<p>In development mode, Xitrum automatically reloads routes and classes in directory
<cite>target/scala-2.11/classes</cite>, so you don&#8217;t need addional tool like
<a class="reference external" href="http://zeroturnaround.com/software/jrebel/">JRebel</a>.</p>
<p>Xitrum uses the new classes to create new instances. Xitrum doesn&#8217;t reload class
instances that have already been created, e.g. instances that are created and
kept in long running threads. This is sufficient for most cases.</p>
<p>When there&#8217;s a change in directory <cite>target/scala-2.11/classes</cite>, Xitrum will
display log:</p>
<div class="highlight-python"><div class="highlight"><pre>[INFO] target/scala-2.11/classes changed; Reload classes and routes on next request
</pre></div>
</div>
<p>You can use SBT to continuously compile your project when there&#8217;s change in your
project source code. Run in a console window other than the console window for
<tt class="docutils literal"><span class="pre">sbt/sbt</span> <span class="pre">run</span></tt> above:</p>
<div class="highlight-python"><div class="highlight"><pre>sbt/sbt ~compile
</pre></div>
</div>
<p>You can also use Eclipse or IntelliJ to edit and compile your project.</p>
<div class="section" id="specify-classes-that-shouldn-t-be-reloaded">
<h3>Specify classes that shouldn&#8217;t be reloaded<a class="headerlink" href="#specify-classes-that-shouldn-t-be-reloaded" title="Permalink to this headline">¶</a></h3>
<p>Because Xitrum creates new a class loader each time it reloads classes, by default
all classes will be reloaded and all Scala objects will be reinitialized in the
new class loader. To avoid that, you may tell Xitrum to use the old ones in the
parent class loader (system class loader) of the new class loader.</p>
<p>There are cases you may want to do that. For example: Heavy classes that take
time to initialize or rarely modified during development.</p>
<p>Another example: Scala objects that contain actors with unique names. Reloading
the objects will cause them to be initialized again, thus cause
<tt class="docutils literal"><span class="pre">akka.actor.InvalidActorNameException:</span> <span class="pre">actor</span> <span class="pre">name</span> <span class="pre">[name</span> <span class="pre">goes</span> <span class="pre">here]</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">unique!</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>package mypackage

object WorkerPool {
  val numWorkers = Runtime.getRuntime.availableProcessors * 2
  val workers    = Seq.tabulate() { i =&gt;
    val name = getClass.getName + &quot;-&quot; + i
    xitrum.Config.actorSystem.actorOf(Props[Worker], name)
  }
}
</pre></div>
</div>
<p>To specify that the above shouldn&#8217;t be reloaded:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xitrum</span><span class="o">.</span><span class="n">DevClassLoader</span><span class="o">.</span><span class="n">ignorePattern</span> <span class="o">=</span> <span class="s">&quot;mypackage</span><span class="se">\\</span><span class="s">.WorkerPool&quot;</span><span class="o">.</span><span class="n">r</span>
</pre></div>
</div>
<p>If you want to disable the autoreload feature, set this before starting
Xitrum server:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xitrum</span><span class="o">.</span><span class="n">Config</span><span class="o">.</span><span class="n">autoreloadInDevMode</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="import-the-project-to-eclipse">
<h2>Import the project to Eclipse<a class="headerlink" href="#import-the-project-to-eclipse" title="Permalink to this headline">¶</a></h2>
<p>You can <a class="reference external" href="http://scala-ide.org/">use Eclipse to write Scala code</a>.</p>
<p>From the project directory, run:</p>
<div class="highlight-python"><div class="highlight"><pre>sbt/sbt eclipse
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">.project</span></tt> file for Eclipse will be created from definitions in <tt class="docutils literal"><span class="pre">build.sbt</span></tt>.
Now open Eclipse, and import the project.</p>
</div>
<div class="section" id="import-the-project-to-intellij">
<h2>Import the project to IntelliJ<a class="headerlink" href="#import-the-project-to-intellij" title="Permalink to this headline">¶</a></h2>
<p>You can also use <a class="reference external" href="http://www.jetbrains.com/idea/">IntelliJ</a>, which also
has very good support for Scala.</p>
<p>To generate project files for IDEA, run:</p>
<div class="highlight-python"><div class="highlight"><pre>sbt/sbt gen-idea
</pre></div>
</div>
</div>
<div class="section" id="ignore-files">
<h2>Ignore files<a class="headerlink" href="#ignore-files" title="Permalink to this headline">¶</a></h2>
<p>Create a new project as described at the <a class="reference internal" href=""><em>tutorial</em></a>.
These should be <a class="reference external" href="https://github.com/xitrum-framework/xitrum-new/blob/master/.gitignore">ignored</a>:</p>
<div class="highlight-python"><div class="highlight"><pre>.*
log
project/project
project/target
routes.cache
target
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#create-a-new-empty-xitrum-project">Create a new empty Xitrum project</a></li>
<li><a class="reference internal" href="#run">Run</a></li>
<li><a class="reference internal" href="#autoreload">Autoreload</a><ul>
<li><a class="reference internal" href="#specify-classes-that-shouldn-t-be-reloaded">Specify classes that shouldn&#8217;t be reloaded</a></li>
</ul>
</li>
<li><a class="reference internal" href="#import-the-project-to-eclipse">Import the project to Eclipse</a></li>
<li><a class="reference internal" href="#import-the-project-to-intellij">Import the project to IntelliJ</a></li>
<li><a class="reference internal" href="#ignore-files">Ignore files</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="intro.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="action_view.html"
                        title="next chapter">Action and view</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="action_view.html" title="Action and view"
             >next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction"
             >previous</a> |</li>
        <li><a href="index.html">Xitrum Scala Web Framework Guide 3.15 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Ngoc Dao.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>